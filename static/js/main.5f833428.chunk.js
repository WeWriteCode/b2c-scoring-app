(window["webpackJsonpb2c-scoring-app"]=window["webpackJsonpb2c-scoring-app"]||[]).push([[0],{38:function(e,t,a){e.exports=a(79)},43:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){},50:function(e,t,a){},51:function(e,t,a){},52:function(e,t,a){},53:function(e,t,a){},54:function(e,t,a){},55:function(e,t,a){},56:function(e,t,a){},57:function(e,t,a){},58:function(e,t,a){},59:function(e,t,a){},60:function(e,t,a){},79:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(17),l=a.n(c),o=(a(43),a(15)),i=a.n(o),s=a(23),u=a(8),m=a(9),p=a(5),f=a(37),h=a(36),d=(a(45),a(46),a(47),a(48),a(49),a(50),a(51),a(52),a(53),a(54),a(55),a(56),a(57),a(58),a(59),a(60),a(14)),g=a(12),y={prependWithPublicUrl:function(e){return"/b2c-scoring-app"+e},convertNumberTo5x5Coordinates:function(e){var t={x:e%5};return e<5&&(t.y=0),e>=5&&e<10&&(t.y=1),e>=10&&e<15&&(t.y=2),e>=15&&e<20&&(t.y=3),e>=20&&e<25&&(t.y=4),t},convertNumberTo4x4Coordinates:function(e){var t={x:e%4};return e<4&&(t.y=0),e>=4&&e<8&&(t.y=1),e>=8&&e<12&&(t.y=2),e>=12&&e<16&&(t.y=3),t},getAdjacentTiles:function(e,t,a,n){var r=[],c={};return c.n=e.find((function(e){return e.x===t.x&&e.y===t.y-1})),c.e=e.find((function(e){return e.x===t.x+1&&e.y===t.y})),c.s=e.find((function(e){return e.x===t.x&&e.y===t.y+1})),c.w=e.find((function(e){return e.x===t.x-1&&e.y===t.y})),r.push(c.n),r.push(c.e),r.push(c.s),r.push(c.w),a&&(c.ne=e.find((function(e){return e.x===t.x+1&&e.y===t.y-1})),c.nw=e.find((function(e){return e.x===t.x-1&&e.y===t.y-1})),c.se=e.find((function(e){return e.x===t.x+1&&e.y===t.y+1})),c.sw=e.find((function(e){return e.x===t.x-1&&e.y===t.y+1})),r.push(c.ne),r.push(c.nw),r.push(c.se),r.push(c.sw)),n?c[n]:r=r.filter(Boolean)},getNameFromToken:function(e){if(e)return e.replace(/-/g," ").replace(/(st)|(mt)/g,(function(e){return e+"."})).split(" ").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" ")},getTypeSpecial:function(e){if(e)return e.split("-")[1]},specificToGenericToken:function(e){if(e)return e.split("-")[0]}},b=[{name:"Original",grid:"four-by-four",id:"original"},{name:"Essential Edition (Capitals)",grid:"five-by-five",id:"capitals"}],v=["st-louis-arch","taj-mahal","colosseum","golden-pavilion","eiffel-tower","pyramids","sydney-harbour-bridge"],E=["factory","house","office","park","shop","tavern-bed","tavern-drink","tavern-food","tavern-music"],T=function(){var e,t,a=b[0];"original"===a.id&&(e=E,t=v);var n=t.map((function(e){var t={};t.token=e,t.name=y.getNameFromToken(e),t.tiles=[],t.score={numParks:0,numHouses:0,numFactories:0,numOffices:0,numShops:0,numTaverns:0,nonHouseTypes:[],uniqueTaverns:[],parkGroups:[],shopGroups:[],factoryMultiplier:2,officesNextToTaverns:0,housesNextToFactories:0,totalScoreParks:0,totalScoreOffices:0,totalScoreHouses:0,totalScoreFactories:0,totalScoreShops:0,totalScoreTaverns:0,totalScore:0};for(var n=0;n<16;n++)!function(n){var r,c={};"original"===a.id&&(r=y.convertNumberTo4x4Coordinates(n)),"capitals"===a.id&&(r=y.convertNumberTo5x5Coordinates(n)),c.city=e,c.number=n,c.x=r.x,c.y=r.y,c.type=null,c.typeSpecial=null,t.tiles.push(c)}(n);return t}));return{game:a,cities:n,tileTypes:e}}();var S=function(e,t){var a=y.specificToGenericToken(t);return e.filter((function(e){return e.type===a})).length};var k=function(e){for(var t=[],a=0;a<e.length;a++)-1===t.indexOf(e[a].type)&&"house"!==e[a].type&&""!==e[a].type&&null!==e[a].type&&"undefined"!==e[a].type&&t.push(e[a].type);return t};var N=function(e){var t=[],a=[];function n(){for(var e=[],n=t.length-1;n>=0;n--)-1===e.indexOf(t[n])&&(e.push(t[n]),t.splice(n,1));a.push(e)}!function(){for(var a=0;a<e.length;a++)"tavern"===e[a].type&&t.push(e[a].typeSpecial)}(),n();do{n()}while(t.length>0);return a.map((function(e){return e.sort()})),a};var w=function(e){for(var t=e.filter((function(e){return"house"===e.type})),a=0,n=0;n<t.length;n++){var r=y.getAdjacentTiles(e,t[n],!0);if(r.length>0)r.filter((function(e){return"factory"===e.type})).length>0&&a++}return a};var C=function(e){for(var t=e.filter((function(e){return"office"===e.type})),a=[],n=0;n<t.length;n++){var r=y.getAdjacentTiles(e,t[n],!1);if(r.length>0)r.filter((function(e){return"tavern"===e.type})).length>0&&a++}return a};var x=function(e){var t,a=0,n=function(e){for(var t=e.filter((function(e){return"park"===e.type})),a=[],n=[],r=[],c=0;c<t.length;c++){var l=[],o=y.getAdjacentTiles(e,t[c],!0).filter((function(e){return"park"===e.type}));if(o.length>0){l.push(t[c].number);for(var i=0;i<o.length;i++)l.push(o[i].number);l.length>0&&a.push(l)}else r.push(t[c].number)}function s(e,t){var a=[],n=t.reduce((function(e,t){return e.concat(t)}),[]);return e.forEach((function(e){n.includes(e[0])||a.push(e)})),a}for(;a.length>0;)n.push((u=a).reduce((function(e,t){if(e.some((function(e){return t.indexOf(e)>=0})))for(var a=0;a<t.length;a++)e.includes(t[a])||e.push(t[a]);return e}),u[0])),a=s(a,n);var u;return{groups:n,solo:r}}(e);return a=2*n.solo.length,t=function(e){var t=0;return e.forEach((function(e){var a=0;a=e.length>3?e.length-3+12:4*e.length,t+=a})),t}(n.groups),{score:a+t,groups:n.groups}};var O=function(e){var t=0,a=e.score.numOffices;function n(e){switch(e){case 0:break;case 1:t+=1;break;case 2:t+=3;break;case 3:t+=6;break;case 4:t+=10;break;case 5:t+=15;break;case 6:t+=21}}return a>6?(t=21*Math.floor(a/6),n(a%6)):n(a),t=Number(t+e.score.officesNextToTaverns)};var M=function(e){var t=0;return t+=e.score.housesNextToFactories,t+=(e.score.numHouses-e.score.housesNextToFactories)*e.score.nonHouseTypes.filter((function(e){return e})).length};var P=function(e){var t,a=0,n=e.tiles.filter((function(e){return"shop"===e.type})),r=[],c={shops:n,soloShops:[],horizontalGroups:[],verticalGroups:[],largestGroup:[]},l=!0;function o(){if(!(c.largestGroup.length<1))for(var e=c.shops.length-1;e>=0;e--)-1!==c.largestGroup.indexOf(c.shops[e])&&c.shops.splice(e,1)}function i(){function e(e,t){return t.length-e.length}function t(){return c.horizontalGroups.length>0}function a(){return c.verticalGroups.length>0}function n(){c.horizontalGroups.sort(e)}function r(){c.verticalGroups.sort(e)}function o(){return n(),c.horizontalGroups[0]}function i(){return r(),c.verticalGroups[0]}c.largestGroup=function(){if(!t()&&!a())return l=!1,[];if(!t())return i();if(!a())return o();if(t()&&a()){n(),r();var c=[o(),i()];return c.sort(e),c[0]}}()}function s(){var t={soloShops:function(){for(var t=[],a=0;a<c.shops.length;a++){0===y.getAdjacentTiles(e.tiles,c.shops[a],!1).filter((function(e){return"shop"===e.type})).length&&t.push(c.shops[a])}return t}(),horizontalGroups:function(){var t=[],a=[];return function(){for(var t=0;t<c.shops.length;t++){var n=!1,r=y.getAdjacentTiles(e.tiles,c.shops[t],!1,"e"),l=y.getAdjacentTiles(e.tiles,c.shops[t],!1,"w");r&&"shop"===r.type&&-1!==c.shops.indexOf(r)&&(n=!0),l&&"shop"===l.type&&-1!==c.shops.indexOf(l)&&(n=!0),n&&a.push(c.shops[t])}}(),function(){for(var e=function(e){var n=a.filter((function(t){return t.y===e}));n.length>1&&t.push(n)},n=0;n<4;n++)e(n)}(),t}(),verticalGroups:function(){var t=[],a=[];return function(){for(var t=0;t<c.shops.length;t++){var n=!1,r=y.getAdjacentTiles(e.tiles,c.shops[t],!1,"n"),l=y.getAdjacentTiles(e.tiles,c.shops[t],!1,"s");r&&"shop"===r.type&&-1!==c.shops.indexOf(r)&&(n=!0),l&&"shop"===l.type&&-1!==c.shops.indexOf(l)&&(n=!0),n&&a.push(c.shops[t])}}(),function(){for(var e=function(e){var n=a.filter((function(t){return t.x===e}));n.length>1&&t.push(n)},n=0;n<4;n++)e(n)}(),t}()};for(var a in t)t.hasOwnProperty(a)&&(c[a]=t[a])}do{s(),i(),c.largestGroup.length>0&&r.push(c.largestGroup),o()}while(l);return t=c.shops,a+=function(){for(var e=0,t=0;t<r.length;t++)switch(r[t].length){case 2:e+=5;break;case 3:e+=10;break;case 4:e+=16}return e}(),{score:a+=2*t.length,groups:r}};var j=function(e){var t=0;return e.score.uniqueTaverns.map((function(e){switch(e.length){case 4:t+=17;break;case 3:t+=9;break;case 2:t+=4;break;case 1:t+=1}return!1})),t};var F=function(e){var t={};e.map((function(e){var a=String(e.score.numFactories);return t.hasOwnProperty(a)||"0"===a||(t[a]=[]),"0"!==a&&t[a].push(e.token),!1})),function(){var e=[];for(var a in t)t.hasOwnProperty(a)&&e.push(a);e.sort((function(e,t){return t-e})),t.firstHasThisManyFactories=e[0],t.secondHasThisManyFactories=e[1]}(),e.map((function(e){var a=t[t.firstHasThisManyFactories],n=t[t.secondHasThisManyFactories];return e.score.factoryMultiplier=2,e.score.factoryBonus="",a&&-1!==a.indexOf(e.token)&&(e.score.factoryMultiplier=4,e.score.factoryBonus="Most Factories"),n&&-1!==n.indexOf(e.token)&&(e.score.factoryMultiplier=3,e.score.factoryBonus="Second Most Factories"),!1}))};var W=function(e){return{score:e.score.factoryMultiplier*e.score.numFactories}},G=function(e){e.map((function(e){return e.score.numParks=S(e.tiles,"park"),e.score.numHouses=S(e.tiles,"house"),e.score.numFactories=S(e.tiles,"factory"),e.score.numOffices=S(e.tiles,"office"),e.score.numShops=S(e.tiles,"shop"),e.score.numTaverns=S(e.tiles,"tavern"),e.score.nonHouseTypes=k(e.tiles),e.score.uniqueTaverns=N(e.tiles),e.score.housesNextToFactories=w(e.tiles),e.score.officesNextToTaverns=C(e.tiles),!1})),F(e),e.map((function(e){return e.score.parkGroups=x(e.tiles).groups,e.score.totalScoreParks=x(e.tiles).score,e.score.totalScoreOffices=O(e),e.score.totalScoreHouses=M(e),e.score.totalScoreFactories=W(e).score,e.score.totalScoreShops=P(e).score,e.score.shopGroups=P(e).groups,e.score.totalScoreTaverns=j(e),!1})),e.map((function(e){return e.score.totalScore=function(e){return[e.score.totalScoreParks,e.score.totalScoreOffices,e.score.totalScoreHouses,e.score.totalScoreFactories,e.score.totalScoreShops,e.score.totalScoreTaverns].reduce((function(e,t){return e+t}),0)}(e),!1}))};var U=function(e){return r.a.createElement("div",null,r.a.createElement("h1",{className:"game-title text-center"},e.game.name),r.a.createElement("ul",{className:"list-panel list-cities"},e.renderCitySummaries(e.cities)))};var H=function(e){var t="";return e.type&&(t+=e.type),e.typeSpecial&&(t+="-".concat(e.typeSpecial)),r.a.createElement("li",null,r.a.createElement("button",{className:e.type,onClick:function(t){return e.showSelectTileModal(t)},type:"button","data-tile-type-special":e.typeSpecial,"data-tile-token":e.type,"data-number":e.number,"data-city":e.city},""!==t?r.a.createElement("img",{alt:"icon",className:"image-tile-icon",src:y.prependWithPublicUrl("/img/icon-".concat(t,"-white.png"))}):null,e.type?r.a.createElement("span",null,y.getNameFromToken(e.type)):"\u2014"," ",e.typeSpecial?"".concat(y.getNameFromToken(e.typeSpecial)):""))};var L=function(e){return r.a.createElement("li",null,r.a.createElement("button",{onClick:function(t){return e.chooseTile(t)},"data-tile-type-special":y.getTypeSpecial(e.tileToken),"data-tile-token":y.specificToGenericToken(e.tileToken),type:"button"},r.a.createElement("img",{alt:"".concat(e.tileToken," icon"),className:"image-tile-icon",src:y.prependWithPublicUrl("/img/tile-".concat(e.tileToken,".gif"))}),y.getNameFromToken(e.tileToken)))};var A=function(e){return r.a.createElement("div",{className:"modal-wrapper"},r.a.createElement("div",{className:"modal"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("button",{onClick:function(t){return e.hideSelectTileModal(t)},className:"close-modal",type:"button"},"Close"),r.a.createElement("h1",{className:"modal-title"},"Choose Tile"),function(t){var a=t.map((function(t,a){return r.a.createElement(L,{chooseTile:e.chooseTile,tileToken:t,key:"".concat(t,"-").concat(a)})}));return r.a.createElement("ul",{className:"list-panel list-tiles"},a)}(e.tiles))))},V=a(32),B=a.n(V);var z=function(e){var t=Object(n.useRef)(null),a=function(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}(),c={width:a.width,height:a.height,facingMode:"environment"},l=r.a.useCallback((function(e){var a=t.current.getScreenshot().split(",");e.handleCameraClick(a[1]),o(),e.toggleWebcam(!1),e.toggleLoading(!0)}),[t]),o=function(){t.current.stream.getTracks().forEach((function(e){return e.stop()}))};return r.a.createElement("div",{className:"webcam"},r.a.createElement(B.a,{screenshotQuality:.8,audio:!1,ref:t,screenshotFormat:"image/jpeg",videoConstraints:c}),r.a.createElement("div",{className:"webcam-button-container"},r.a.createElement("button",{className:"webcam-capture",type:"button",onClick:function(){return l(e)}},"Capture Photo")))},q=a(33),D=a.n(q);var R=function(e){var t,a=new URLSearchParams(e.location.search).get("token"),n=e.cities.filter((function(e){return e.token===a}))[0];return r.a.createElement("div",null,r.a.createElement(d.b,{to:"/",className:"link-back"},"Back"),r.a.createElement("h1",{className:"city-heading"},r.a.createElement("img",{alt:"".concat(n.token," icon"),className:"image-city-token",src:y.prependWithPublicUrl("/img/token-".concat(n.token,".gif"))}),n.name,r.a.createElement("span",{className:"city-score"},n.score.totalScore)),r.a.createElement("div",{className:"city-buttons"},r.a.createElement("button",{className:e.showCityTiles?"active":null,onClick:e.handleShowCityTiles,type:"button"},"Tiles"),r.a.createElement("button",{className:e.showCityTiles?null:"active",onClick:e.handleShowCityScores,type:"button"},"Scores"),r.a.createElement("button",{onClick:function(){return e.toggleWebcam(!0)},type:"button"},"Take Photo")),r.a.createElement(D.a,{active:e.isLoading,spinner:!0,text:"Processing image ..."},e.showCityTiles?function(t){var n=t.map((function(t,n){return r.a.createElement(H,{type:t.type,typeSpecial:t.typeSpecial,showSelectTileModal:e.showSelectTileModal,number:n,city:a,key:n})}));return r.a.createElement("ol",{className:"city-grid ".concat(e.game.grid)},n)}(n.tiles):(t=n.score,r.a.createElement("div",null,r.a.createElement("table",{className:"city-score-table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"city-score-table-number"},"#"),r.a.createElement("th",null,"Tile"),r.a.createElement("th",null,"Sets and Modifiers"),r.a.createElement("th",{className:"city-score-table-number"},"Total"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{className:"city-score-table-number"},t.numFactories),r.a.createElement("td",null,r.a.createElement("button",{className:"city-score-legend",type:"button"},r.a.createElement("img",{alt:"Factory icon",className:"image-tile-icon",src:y.prependWithPublicUrl("/img/tile-factory.gif")}),r.a.createElement("span",null,"Factory"))),r.a.createElement("td",null,r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,4===t.factoryMultiplier?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{className:"image-medal-icon",alt:"Gold medal",src:y.prependWithPublicUrl("/img/icon-gold.gif")}),"Most"):null,3===t.factoryMultiplier?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{className:"image-medal-icon",alt:"Silver medal",src:y.prependWithPublicUrl("/img/icon-silver.gif")}),"Second-Most"):null,t.factoryMultiplier>2?r.a.createElement("span",{className:"city-score-modifier"},"x",t.factoryMultiplier," per"):null))))),r.a.createElement("td",{className:"city-score-table-number"},t.totalScoreFactories)),r.a.createElement("tr",null,r.a.createElement("td",{className:"city-score-table-number"},t.numOffices),r.a.createElement("td",null,r.a.createElement("button",{className:"city-score-legend",type:"button"},r.a.createElement("img",{alt:"Office icon",className:"image-tile-icon",src:y.prependWithPublicUrl("/img/tile-office.gif")}),r.a.createElement("span",null,"Office"))),r.a.createElement("td",null,t.officesNextToTaverns>0?function(e){for(var t=[],a=0;a<e;a+=1)t.push(r.a.createElement("tr",{key:"office-".concat(a)},r.a.createElement("td",null,r.a.createElement("div",{className:"css-icon-container"},r.a.createElement("span",{className:"office"})),r.a.createElement("div",{className:"css-icon-container"},r.a.createElement("span",{className:"tavern"})),r.a.createElement("span",{className:"city-score-modifier"},"+1"))));return r.a.createElement("table",null,r.a.createElement("tbody",null,t))}(t.officesNextToTaverns):""),r.a.createElement("td",{className:"city-score-table-number"},t.totalScoreOffices)),r.a.createElement("tr",null,r.a.createElement("td",{className:"city-score-table-number"},t.numHouses),r.a.createElement("td",null,r.a.createElement("button",{className:"city-score-legend",type:"button"},r.a.createElement("img",{alt:"House icon",className:"image-tile-icon",src:y.prependWithPublicUrl("/img/tile-house.gif")}),r.a.createElement("span",null,"House"))),r.a.createElement("td",null,t.nonHouseTypes.length>0?function(e){var t=e.map((function(e,t){return r.a.createElement("div",{key:"group-".concat(t),className:"css-icon-container noborder"},r.a.createElement("span",{className:"".concat(e)}))}));return r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,t,r.a.createElement("span",{className:"city-score-modifier"},"x".concat(e.length," per"))))))}(t.nonHouseTypes):"",t.housesNextToFactories>0?function(e){for(var t=[],a=0;a<e;a+=1)t.push(r.a.createElement("tr",{key:"row-".concat(a)},r.a.createElement("td",null,r.a.createElement("div",{className:"css-icon-container"},r.a.createElement("span",{className:"house"})),r.a.createElement("div",{className:"css-icon-container"},r.a.createElement("span",{className:"factory"})),r.a.createElement("span",{className:"city-score-modifier"},"x1 per"),"\xa0")));return r.a.createElement("table",null,r.a.createElement("tbody",null,t))}(t.housesNextToFactories):""),r.a.createElement("td",{className:"city-score-table-number"},t.totalScoreHouses)),r.a.createElement("tr",null,r.a.createElement("td",{className:"city-score-table-number"},t.numParks),r.a.createElement("td",null,r.a.createElement("button",{className:"city-score-legend",type:"button"},r.a.createElement("img",{alt:"Park icon",className:"image-tile-icon",src:y.prependWithPublicUrl("/img/tile-park.gif")}),r.a.createElement("span",null,"Park"))),r.a.createElement("td",null,t.numParks>0?function(e){var t=e.map((function(e,t){for(var a=[],n=0;n<e.length;n+=1)a.push(r.a.createElement("div",{key:"group-".concat(t,"-park-icon-").concat(n),className:"css-icon-container"},r.a.createElement("span",{className:"park"})));return r.a.createElement("tr",{key:"group-".concat(t)},r.a.createElement("td",null,a,2===e.length?r.a.createElement("span",{className:"city-score-modifier"},"+8"):null,3===e.length?r.a.createElement("span",{className:"city-score-modifier"},"+12"):null,e.length>3?r.a.createElement("span",{className:"city-score-modifier"},"+".concat(String(12+e.length-3))):null))}));return r.a.createElement("table",null,r.a.createElement("tbody",null,t))}(t.parkGroups):""),r.a.createElement("td",{className:"city-score-table-number"},t.totalScoreParks)),r.a.createElement("tr",null,r.a.createElement("td",{className:"city-score-table-number"},t.numShops),r.a.createElement("td",null,r.a.createElement("button",{className:"city-score-legend",type:"button"},r.a.createElement("img",{alt:"Shop icon",className:"image-tile-icon",src:y.prependWithPublicUrl("/img/tile-shop.gif")}),r.a.createElement("span",null,"Shop"))),r.a.createElement("td",null,t.shopGroups.length>0?function(e){var t=e.map((function(e,t){for(var a=[],n=0;n<e.length;n+=1)a.push(r.a.createElement("div",{className:"css-icon-container",key:"group-".concat(t,"-shop-").concat(n)},r.a.createElement("span",{className:"shop"})));return r.a.createElement("tr",{key:"".concat(e,"-").concat(t)},r.a.createElement("td",null,a,2===e.length?r.a.createElement("span",{className:"city-score-modifier"},"+5"):null,3===e.length?r.a.createElement("span",{className:"city-score-modifier"},"+10"):null,4===e.length?r.a.createElement("span",{className:"city-score-modifier"},"+16"):null))}));return r.a.createElement("table",null,r.a.createElement("tbody",null,t))}(t.shopGroups):""),r.a.createElement("td",{className:"city-score-table-number"},t.totalScoreShops)),r.a.createElement("tr",null,r.a.createElement("td",{className:"city-score-table-number"},t.numTaverns),r.a.createElement("td",null,r.a.createElement("button",{className:"city-score-legend",type:"button"},r.a.createElement("img",{alt:"Tavern icon",className:"image-tile-icon",src:y.prependWithPublicUrl("/img/tile-tavern-drink.gif")}),r.a.createElement("span",null,"Tavern"))),r.a.createElement("td",null,function(e){var t=e.map((function(e,t){return e.length>0?r.a.createElement("tr",{key:"group-".concat(t)},r.a.createElement("td",{className:"tavern-icon-score-group"},e.map((function(e,t){return r.a.createElement("div",{key:"img-".concat(e,"-").concat(t),className:"image-special-tavern-icon"},r.a.createElement("img",{alt:"".concat(e," icon"),key:"".concat(e,"-").concat(t),src:y.prependWithPublicUrl("/img/icon-tavern-".concat(e,".png"))}))})),r.a.createElement("span",{className:"city-score-modifier"},1===e.length?"+1":"",2===e.length?"+4":"",3===e.length?"+9":"",4===e.length?"+17":""))):null}));return r.a.createElement("table",null,r.a.createElement("tbody",null,t))}(t.uniqueTaverns)),r.a.createElement("td",{className:"city-score-table-number"},t.totalScoreTaverns))))))),!1===e.isWebcamVisible?null:r.a.createElement(z,{toggleLoading:e.toggleLoading,toggleWebcam:e.toggleWebcam,handleCameraClick:e.handleCameraClick}),!1===e.isSelectTileModalVisible?null:r.a.createElement(A,{hideSelectTileModal:e.hideSelectTileModal,chooseTile:e.chooseTile,tiles:e.tiles}))};var J=function(e){return r.a.createElement("li",null,r.a.createElement(d.b,{to:{pathname:"/city",search:"?token=".concat(e.token)}},r.a.createElement("img",{alt:"".concat(e.token," icon"),className:"image-city-token",src:y.prependWithPublicUrl("/img/token-".concat(e.token,".gif"))}),r.a.createElement("h3",null,e.name),r.a.createElement("span",{className:"total-score"},e.score.totalScore>0?e.score.totalScore:0)))},I=a(81),Q=function(e){Object(f.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={cities:T.cities,tiles:T.tileTypes,game:T.game,isSelectTileModalVisible:!1,isWebcamVisible:!1,showCityTiles:!0,tileToUpdate:null,isLoading:!1},n.renderCitySummaries=n.renderCitySummaries.bind(Object(p.a)(n)),n.showSelectTileModal=n.showSelectTileModal.bind(Object(p.a)(n)),n.hideSelectTileModal=n.hideSelectTileModal.bind(Object(p.a)(n)),n.chooseTile=n.chooseTile.bind(Object(p.a)(n)),n.updateSetupData=n.updateSetupData.bind(Object(p.a)(n)),n.handleShowCityTiles=n.handleShowCityTiles.bind(Object(p.a)(n)),n.handleShowCityScores=n.handleShowCityScores.bind(Object(p.a)(n)),n.toggleWebcam=n.toggleWebcam.bind(Object(p.a)(n)),n.toggleLoading=n.toggleLoading.bind(Object(p.a)(n)),n.handleCameraClick=n.handleCameraClick.bind(Object(p.a)(n)),n}return Object(m.a)(a,[{key:"handleCameraClick",value:function(){var e=Object(s.a)(i.a.mark((function e(t){var a,n,r,c,l,o,s,u,m,p;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=document.getElementsByClassName("city-grid")[0],n=a.getElementsByTagName("li"),e.next=4,this.roboflowPredict(t);case 4:for(r=e.sent,this.toggleLoading(!1),c=0;c<n.length;c++)l=n[c].getElementsByTagName("button")[0],o=l.getAttribute("data-number"),s=l.getAttribute("data-city"),u=r.data.gridRows[o],m=u.itemName?u.itemName.toLowerCase().split("-")[0]:null,p=u.itemName?u.itemName.toLowerCase().split("-")[1]:null,this.updateSetupData(m,p,s,o);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"roboflowPredict",value:function(){var e=Object(s.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={image:t},e.next=3,Object(I.a)({method:"POST",url:"https://aqco4tv2c5.execute-api.us-east-1.amazonaws.com/staging",data:a});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleShowCityTiles",value:function(){this.setState({showCityTiles:!0})}},{key:"handleShowCityScores",value:function(){this.setState({showCityTiles:!1})}},{key:"showSelectTileModal",value:function(e){var t=e.currentTarget.getAttribute("data-number"),a=e.currentTarget.getAttribute("data-city");this.setState({tileToUpdate:{city:a,number:t},isSelectTileModalVisible:!0})}},{key:"toggleWebcam",value:function(e){this.setState({isWebcamVisible:e})}},{key:"toggleLoading",value:function(e){this.setState({isLoading:e})}},{key:"hideSelectTileModal",value:function(){this.setState({tileToUpdate:null,isSelectTileModalVisible:!1})}},{key:"chooseTile",value:function(e){var t=e.currentTarget.getAttribute("data-tile-token"),a=e.currentTarget.getAttribute("data-tile-type-special"),n=this.state.tileToUpdate.city,r=this.state.tileToUpdate.number;this.updateSetupData(t,a,n,r)}},{key:"updateSetupData",value:function(e,t,a,n){var r=T.cities.filter((function(e){return e.token===a}))[0].tiles[n];r.type=e,r.typeSpecial=t,G(T.cities),this.setState({cities:T.cities,isSelectTileModalVisible:!1,tileToUpdate:null})}},{key:"renderCitySummaries",value:function(e){return e.map((function(e){return r.a.createElement(J,{score:e.score,token:e.token,name:e.name,key:e.token})}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"wrapper"},r.a.createElement(d.a,{basename:"/"},r.a.createElement(g.a,{exact:!0,path:"/",render:function(t){return r.a.createElement(U,Object.assign({game:e.state.game,cities:e.state.cities,renderCitySummaries:e.renderCitySummaries},t))}}),r.a.createElement(g.a,{path:"/city",render:function(t){return r.a.createElement(R,Object.assign({game:e.state.game,tiles:e.state.tiles,isSelectTileModalVisible:e.state.isSelectTileModalVisible,cities:e.state.cities,showCityTiles:e.state.showCityTiles,chooseTile:e.chooseTile,isWebcamVisible:e.state.isWebcamVisible,isLoading:e.state.isLoading,handleShowCityScores:e.handleShowCityScores,handleShowCityTiles:e.handleShowCityTiles,showSelectTileModal:e.showSelectTileModal,hideSelectTileModal:e.hideSelectTileModal,toggleWebcam:e.toggleWebcam,toggleLoading:e.toggleLoading,handleCameraClick:e.handleCameraClick},t))}})))}}]),a}(n.Component);l.a.render(r.a.createElement(Q,null),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.5f833428.chunk.js.map